(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{171:function(t,e,s){t.exports=s.p+"assets/img/kargo-example-assumptions.0161491c.svg"},180:function(t,e,s){"use strict";s.r(e);var a=[function(){var t=this.$createElement,e=this._self._c||t;return e("h1",{attrs:{id:"getting-started"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#getting-started","aria-hidden":"true"}},[this._v("#")]),this._v(" Getting Started")])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("Using "),e("strong",[this._v("kargo")]),this._v(" is quite easy and basically the approach to setup your Geospatial platform is the following:")])},function(){var t=this.$createElement,e=this._self._c||t;return e("ul",[e("li",[e("a",{attrs:{href:"#prepare-the-infrastructure"}},[this._v("Prepare the infrastructure")])]),this._v(" "),e("li",[e("a",{attrs:{href:"#setup-the-services"}},[this._v("Setup the services")])]),this._v(" "),e("li",[e("a",{attrs:{href:"#manage-the-services"}},[this._v("Manage the services")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[e("img",{attrs:{src:s(171),alt:"kargo-example-assumptions"}})])},function(){var t=this.$createElement,e=this._self._c||t;return e("ul",[e("li",[this._v("A manager node")]),this._v(" "),e("li",[this._v("Multiple worker nodes with sufficient disk space to store the data")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("Check your infrastructure using the command "),e("code",[this._v("docker node ls")]),this._v(", you should have a response similar to:")])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token variable"}},[this._v("$docker")]),this._v(" node "),e("span",{pre:!0,attrs:{class:"token function"}},[this._v("ls")]),this._v("\nID                            HOSTNAME            STATUS              AVAILABILITY        MANAGER STATUS      ENGINE VERSION\njqtuxajexk18ypiylk6i6dv0q     worker-0            Ready               Active                                  18.03.1-ce\nx6tc2sqi99vp106icwf2nmyp0 *   manager             Ready               Active              Leader              18.03.1-ce\nwfr5hwhfd5413p2ql9hwitbkw     worker-1            Ready               Active                                  18.03.1-ce\n8980x3d76x1r7kxoa7h5lzob8     worker-2            Ready               Active                                  18.03.1-ce\n")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("h2",{attrs:{id:"prepare-the-infrastructure"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#prepare-the-infrastructure","aria-hidden":"true"}},[this._v("#")]),this._v(" Prepare the infrastructure")])},function(){var t=this.$createElement,e=this._self._c||t;return e("h3",{attrs:{id:"install-the-prerequisites"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#install-the-prerequisites","aria-hidden":"true"}},[this._v("#")]),this._v(" Install the prerequisites")])},function(){var t=this.$createElement,e=this._self._c||t;return e("h4",{attrs:{id:"install-a-local-registry"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#install-a-local-registry","aria-hidden":"true"}},[this._v("#")]),this._v(" Install a local Registry")])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("Some of the services proposed by "),e("strong",[this._v("Kargo")]),this._v(" need to be built before you can deploy it. For this reason, it is necessary to have a local Registry on the Manager node to store the images.")])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("To install it you can run the command "),e("code",[this._v("docker stack deploy -c registry.yml registry")]),this._v(" where the Compose file "),e("code",[this._v("registry.yml")]),this._v(" has the following content:")])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[this._v("version: '3.5'\n\nservices:\n  registry:\n    image: registry:2\n    ports:\n      - 5000:5000\n    networks:\n      - swarm-network\n    deploy:\n      replicas: 1\n      placement:\n        constraints:\n          - node.role == manager\n\nnetworks:\n  swarm-network:\n    name: <swarm network>\n    external: true\n")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("h4",{attrs:{id:"install-sshfs"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#install-sshfs","aria-hidden":"true"}},[this._v("#")]),this._v(" Install SSHFS")])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("p",[t._v("As we will see later, "),s("strong",[t._v("SSHFS")]),t._v(" is used to share the "),s("strong",[t._v("Kargo")]),t._v(" configuration among the nodes. You need to install "),s("strong",[t._v("SSHFS")]),t._v(" on each worker.\nTo install "),s("strong",[t._v("SSHFS")]),t._v(" you may run the following procedure:")])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("apt-get")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v(" sshfs\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Edit fuse conf to enable the allow_other option")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("nano")]),t._v(" /etc/fuse.conf and uncomment the line\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#user_allow_other")]),t._v("\n")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("h4",{attrs:{id:"install-rclone"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#install-rclone","aria-hidden":"true"}},[this._v("#")]),this._v(" Install rclone")])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("p",[s("strong",[t._v("rclone")]),t._v(" is used to provision the nodes with the static data that are used by the services (i.e. geospatial datasets, docker images...). "),s("strong",[t._v("rclone")]),t._v(" allows you to retrieve these data from most\nof the well know stores such as "),s("strong",[t._v("AWS S3")]),t._v(", "),s("strong",[t._v("OpenStack Object Store")]),t._v(", "),s("strong",[t._v("Google Drive")]),t._v(".\nYou need to install "),s("strong",[t._v("rclone")]),t._v(" on each worker:")])},function(){var t=this.$createElement,e=this._self._c||t;return e("ol",[e("li",[this._v("Install "),e("strong",[this._v("rclone")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[this._v("sudo")]),this._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[this._v("apt-get")]),this._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[this._v("install")]),this._v(" rclone\n")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("ol",{attrs:{start:"2"}},[e("li",[this._v("Configure "),e("strong",[this._v("rclone")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("h4",{attrs:{id:"install-jq"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#install-jq","aria-hidden":"true"}},[this._v("#")]),this._v(" Install jq")])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[this._v("sudo")]),this._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[this._v("apt-get")]),this._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[this._v("install")]),this._v(" jq\n")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("h3",{attrs:{id:"install-kargo"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#install-kargo","aria-hidden":"true"}},[this._v("#")]),this._v(" Install kargo")])},function(){var t=this.$createElement,e=this._self._c||t;return e("ol",[e("li",[this._v("Clone the "),e("strong",[this._v("Kargo")]),this._v(" repository")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token variable"}},[this._v("$git")]),this._v(" clone https://github.com/kalisio/kargo.git\n")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("ol",{attrs:{start:"2"}},[e("li",[this._v("Share the "),e("strong",[this._v("Kargo")]),this._v(" configuration with the workers.")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("On each worker, use "),e("code",[this._v("sshfs")]),this._v(" to share the "),e("code",[this._v("configs")]),this._v(" directory. The path to the shared directory must be the same on the workers as on the manager.")])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[t._v("mkdir")]),t._v(" -p /home/ubuntu/kargo/.kargo/configs\nsshfs ubuntu@"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("swam manager ip"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(":/home/ubuntu/kargo/.kargo/configs /home/ubuntu/kargo/.kargo/configs -o IdentityFile"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("/home/ubuntu/.ssh/ssh.pem -o allow_other\n")])])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[t._v("@reboot sshfs ubuntu@"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("swam manager ip"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(":/home/ubuntu/kargo/.kargo/configs /home/ubuntu/kargo/.kargo/configs -o IdentityFile"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("/home/ubuntu/.ssh/ssh.pem -o allow_other -o StrictHostKeyChecking"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("no\n")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"warning custom-block"},[e("p",{staticClass:"custom-block-title"},[this._v("WARNING")]),this._v(" "),e("p",[this._v("As we faced various issues using "),e("code",[this._v("/etc/fstab")]),this._v(" to automatically mount the the shared directory, we found more convenient to use use the crontab solution.")])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"tip custom-block"},[s("p",{staticClass:"custom-block-title"},[t._v("TIP")]),t._v(" "),s("p",[s("strong",[t._v("Kargo")]),t._v(" provides an helper script that can be used to share the configuration. You have to copy the script on each nodes and execute it with the manager private IP:")]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[t._v("$./setup-worker "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("manager_private_ip"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n")])])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("h3",{attrs:{id:"provision-the-data"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#provision-the-data","aria-hidden":"true"}},[this._v("#")]),this._v(" Provision the data")])},function(){var t=this.$createElement,e=this._self._c||t;return e("h3",{attrs:{id:"define-node-constraints"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#define-node-constraints","aria-hidden":"true"}},[this._v("#")]),this._v(" Define node constraints")])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# On worker-0")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$docker")]),t._v(" node update --label-add tileservergl"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("true jqtuxajexk18ypiylk6i6dv0q\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# On worker-1 ")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$docker")]),t._v(" node update --label-add weacast"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("true wfr5hwhfd5413p2ql9hwitbkw\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# On worker-2")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$docker")]),t._v(" node update --label-add mongodb"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("true 8980x3d76x1r7kxoa7h5lzob8\n"),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$docker")]),t._v(" node update --label-add postgis"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("true 8980x3d76x1r7kxoa7h5lzob8\n")])])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$docker")]),t._v(" node "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("ls")]),t._v(" -q "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("xargs")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" docker node inspect -f "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'{{ .ID }} [{{ .Description.Hostname }}]: {{ .Spec.Labels }}'")]),t._v("\njqtuxajexk18ypiylk6i6dv0q "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("worker-0"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(": map"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("tileservergl:true"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\nx6tc2sqi99vp106icwf2nmyp0 "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("manager"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(": map"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\nwfr5hwhfd5413p2ql9hwitbkw "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("worker-1"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(": map"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("weacast:true"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n8980x3d76x1r7kxoa7h5lzob8 "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("worker-2"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(": map"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("mongodb:true postgis:true"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("h2",{attrs:{id:"setup-the-services"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#setup-the-services","aria-hidden":"true"}},[this._v("#")]),this._v(" Setup the services")])},function(){var t=this.$createElement,e=this._self._c||t;return e("h3",{attrs:{id:"setup-your-workspace"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#setup-your-workspace","aria-hidden":"true"}},[this._v("#")]),this._v(" Setup your workspace")])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("ol",[s("li",[s("p",[t._v("Create a directory to store your configuration stuff. Give it the name of your choice.")])]),t._v(" "),s("li",[s("p",[t._v("Create the "),s("strong",[t._v("Environment")]),t._v(" file by making a copy of the "),s("code",[t._v(".env.sample")]),t._v(" file into your configuration. Rename it as "),s("code",[t._v(".env")])])]),t._v(" "),s("li",[s("p",[t._v("Edit the "),s("code",[t._v(".env")]),t._v(" file and configure the services you want to deploy. See the section "),s("a",{attrs:{href:"./reference/environment"}},[t._v("Environment")]),t._v(" to have the complete reference of the services settings.")])]),t._v(" "),s("li",[s("p",[t._v("Define the stacks you want to deploy:")]),t._v(" "),s("ol",[s("li",[t._v("Define the "),s("code",[t._v("STACKS")]),t._v(" variable listing the stacks")]),t._v(" "),s("li",[t._v("For each stacks, define a variable "),s("code",[t._v("<NAME>_STACK")]),t._v(" listing the services to deploy")])])])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[t._v("STACKS"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"dbs weacast hydro air apps"')]),t._v("\nAPPS_STACK"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"tileservergl mapproxy maputnik thredds kano"')]),t._v("\nDBS_STACK"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"mongodb"')]),t._v("\nWEACAST_STACK"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"arpege-world-loader arpege-europe-loader arome-france-loader gfs-world-loader weacast"')]),t._v("\nVIGICRUES_HYDRO"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"vigicrues hubeau-stations hubeau-observations"')]),t._v("\nAIR_STACK"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"teleray openaq"')]),t._v("\n")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("ol",{attrs:{start:"5"}},[e("li",[this._v("Tell kargo to use your workspace")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[this._v("$./kargo use "),e("span",{pre:!0,attrs:{class:"token operator"}},[this._v("<")]),this._v("path/to/your/workspace/directory"),e("span",{pre:!0,attrs:{class:"token operator"}},[this._v(">")]),this._v("\n")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"tip custom-block"},[e("p",{staticClass:"custom-block-title"},[this._v("TIP")]),this._v(" "),e("p",[this._v("We strongly recommend to use "),e("strong",[this._v("Git")]),this._v(" to manage your workspace")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("h3",{attrs:{id:"generate-the-configuration"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#generate-the-configuration","aria-hidden":"true"}},[this._v("#")]),this._v(" Generate the configuration")])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("Since "),e("strong",[this._v("Kargo")]),this._v(" allows you to override the default configuration with your workspace configuration, it is required to generate the merged configuration before deploying the services. Simply, run the command:")])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[this._v("$./kargo update\n")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"tip custom-block"},[e("p",{staticClass:"custom-block-title"},[this._v("TIP")]),this._v(" "),e("p",[this._v("When using "),e("strong",[this._v("Git")]),this._v(" to manage your workspace, you can take advantage of the command "),e("code",[this._v("kargo pull")]),this._v(" to pull the workspace.")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("h3",{attrs:{id:"build-the-services"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#build-the-services","aria-hidden":"true"}},[this._v("#")]),this._v(" Build the services")])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("Some of the services provided By "),e("strong",[this._v("Kargo")]),this._v(" need to be built and pushed to the local registry in order to be able to deploy them.\nYou simply need to run the command:")])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[this._v("$./kargo build "),e("span",{pre:!0,attrs:{class:"token operator"}},[this._v("<")]),this._v("service"),e("span",{pre:!0,attrs:{class:"token operator"}},[this._v(">")]),this._v("\n")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("h2",{attrs:{id:"manage-the-services"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#manage-the-services","aria-hidden":"true"}},[this._v("#")]),this._v(" Manage the services")])},function(){var t=this.$createElement,e=this._self._c||t;return e("h3",{attrs:{id:"getting-information"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#getting-information","aria-hidden":"true"}},[this._v("#")]),this._v(" Getting information")])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("You can retrieve some information about the current configuration using the command "),e("code",[this._v("info")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[this._v("$./kargo info\n")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("h3",{attrs:{id:"deploy-the-services"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#deploy-the-services","aria-hidden":"true"}},[this._v("#")]),this._v(" Deploy the services")])},function(){var t=this.$createElement,e=this._self._c||t;return e("ul",[e("li",[this._v("Deploy a stack")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[this._v("$./kargo deploy "),e("span",{pre:!0,attrs:{class:"token operator"}},[this._v("<")]),this._v("stack"),e("span",{pre:!0,attrs:{class:"token operator"}},[this._v(">")]),this._v("\n")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("ul",[e("li",[this._v("Deploy all the stacks")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[this._v("$./deploy deploy all\n")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("h3",{attrs:{id:"remove-the-services"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#remove-the-services","aria-hidden":"true"}},[this._v("#")]),this._v(" Remove the services")])},function(){var t=this.$createElement,e=this._self._c||t;return e("ul",[e("li",[this._v("Remove a stack")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[this._v("$./kargo remove "),e("span",{pre:!0,attrs:{class:"token operator"}},[this._v("<")]),this._v("stack"),e("span",{pre:!0,attrs:{class:"token operator"}},[this._v(">")]),this._v("\n")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("ul",[e("li",[this._v("Remove all the stacks")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[this._v("$./remove remove all\n")])])])}],r=s(0),n=Object(r.a)({},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"content"},[t._m(0),t._v(" "),t._m(1),t._v(" "),t._m(2),t._v(" "),s("p",[t._v("In the following guides, we will explain how to deploy a complete set of services on a given infrastructure such as illustrated in this diagram:")]),t._v(" "),t._m(3),t._v(" "),s("p",[t._v("Thus, we assume you already have a running Swarm infrastructure with:")]),t._v(" "),t._m(4),t._v(" "),t._m(5),t._v(" "),t._m(6),s("div",{staticClass:"warning custom-block"},[s("p",{staticClass:"custom-block-title"},[t._v("Prerequisites")]),t._v(" "),s("p",[t._v("If you do not have such an infrastructure, you may have a look at "),s("a",{attrs:{href:"https://kalisio.github.io/kaabah/",target:"_blank",rel:"noopener noreferrer"}},[s("strong",[t._v("Kaabah")]),s("OutboundLink")],1),t._v(".")])]),t._v(" "),t._m(7),t._v(" "),t._m(8),t._v(" "),t._m(9),t._v(" "),t._m(10),t._v(" "),t._m(11),t._v(" "),t._m(12),t._m(13),t._v(" "),t._m(14),t._v(" "),t._m(15),t._m(16),t._v(" "),t._m(17),t._v(" "),t._m(18),t._v(" "),t._m(19),t._m(20),t._v(" "),s("p",[t._v("Use the "),s("a",{attrs:{href:"https://rclone.org/docs/#configure",target:"_blank",rel:"noopener noreferrer"}},[t._v("following guide"),s("OutboundLink")],1),t._v(" to setup "),s("strong",[t._v("rclone")])]),t._v(" "),t._m(21),t._v(" "),s("p",[s("strong",[s("a",{attrs:{href:"https://stedolan.github.io/jq/",target:"_blank",rel:"noopener noreferrer"}},[t._v("jq"),s("OutboundLink")],1)]),t._v(" is a lightweight and flexible command-line JSON processor. The CLI uses "),s("strong",[t._v("jq")]),t._v(" to extract some information from the "),s("code",[t._v("package.json")]),t._v(" file.")]),t._v(" "),s("p",[t._v("On the manager, type the following command:")]),t._v(" "),t._m(22),t._m(23),t._v(" "),t._m(24),t._v(" "),s("p",[t._v("On the manager node, clone the repository in your home directory:")]),t._v(" "),t._m(25),t._m(26),t._v(" "),t._m(27),t._v(" "),t._m(28),s("p",[t._v("For the volume to be permanently mounted (even at restart), we can add the following entry in the crontab:")]),t._v(" "),t._m(29),t._m(30),t._v(" "),t._m(31),t._v(" "),t._m(32),t._v(" "),s("p",[t._v("It is up to you to copy your data to the different nodes. You must have to keep in mind that these data will have to be accessible by the services that you want to deploy.")]),t._v(" "),s("div",{staticClass:"tip custom-block"},[s("p",{staticClass:"custom-block-title"},[t._v("Looking for data ?")]),t._v(" "),s("p",[t._v("We can provide datasets from different sources such as public catalogs and those of our partners such as "),s("a",{attrs:{href:"https://openmaptiles.com/",target:"_blank",rel:"noopener noreferrer"}},[t._v("OpenMapTiles"),s("OutboundLink")],1),t._v(", "),s("a",{attrs:{href:"https://www.planetobserver.com/",target:"_blank",rel:"noopener noreferrer"}},[t._v("PlanetObserver"),s("OutboundLink")],1),t._v(". Do bot hesitate to contact us at contact@kalisio.com.")])]),t._v(" "),t._m(33),t._v(" "),s("p",[t._v("Once you have copy the datasets to the different nodes, you need to add some labels to the nodes that can be used to specify constraints when deploying the services.")]),t._v(" "),s("p",[t._v("In our case, we need to add the following labels:")]),t._v(" "),t._m(34),s("p",[t._v("Check your node labels mapping:")]),t._v(" "),t._m(35),t._m(36),t._v(" "),t._m(37),t._v(" "),t._m(38),t._v(" "),t._m(39),t._m(40),t._v(" "),t._m(41),t._m(42),t._v(" "),t._m(43),t._v(" "),t._m(44),t._v(" "),t._m(45),t._m(46),t._v(" "),t._m(47),t._v(" "),t._m(48),t._v(" "),t._m(49),t._m(50),t._v(" "),t._m(51),t._v(" "),t._m(52),t._v(" "),t._m(53),t._m(54),t._v(" "),s("p",[t._v("You can either deploy a given stack or deploy all the stacks.")]),t._v(" "),t._m(55),t._v(" "),t._m(56),t._m(57),t._v(" "),t._m(58),t._m(59),t._v(" "),s("p",[t._v("You can either remove a given stack or remove all the stacks.")]),t._v(" "),t._m(60),t._v(" "),t._m(61),t._m(62),t._v(" "),t._m(63)])},a,!1,null,null,null);n.options.__file="getting-started.md";e.default=n.exports}}]);